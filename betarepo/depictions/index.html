<!DOCTYPE html>
<html>
<head>
    <title>Depiction</title>
	<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
	<meta http-equiv="Pragma" content="no-cache" />
	<meta http-equiv="Expires" content="0" />	
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0"/>
	<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <base target="_blank"/>
    <!--link rel="stylesheet" type="text/css" id="stylesheet" href="css/ios78.css"-->
	<link rel="stylesheet" type="text/css" id="stylesheet" href="themes/simpleicon/css/styles.css">
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script type="text/javascript" src="js/jquery.querystring.js"></script>
    <script type="text/javascript" src="js/depiction-engine.js"></script>
    <script type="text/javascript">
	
	bundleid = $.QueryString['p'];	
	
    var contentBlocks = 	{
    	"packageName"		: {"type":"text","source":"package>name"}
		,"packageVersion"	: {"type":"text"
								,"source" :"package>version"}
        ,"descriptionList"	: {"type":"list"  
								,"source" :"package>descriptionlist>description"
								,"reverseRender":true
								,"panel":"#descriptionPanel"}
		,"changesList"      : {"type":"list"  
								,"source" :"package>changelog>change"
								,"reverseRender":true
								,"panel":"#changesPanel"}
		,"fullChangelogLink": {"type":"link"
								,"text":"Full Changelog"
								,"url":"changelog.html"
								,"params":[
									['p',bundleid]
								]}
		,"dependencyList"	: {"type":"list"  
								,"source" :"package>dependencies>package"
								,"panel":"#dependenciesPanel"}
		,"linksList"		: {"type":"custom"  
								,"source" :"package>links>link"
								,"render":function(element,value){
									if ($(value).size()==0) {
										$('#linksPanel').remove()
									} else {
										$.each(value, function(){
											console.log(this);
											var htmltag = '<li><a href="'+$(this).find('link > url').text()+'">'+$(this).find('link > name').text()+'</a></li>';
											$(element.append(htmltag))

										})
									}
									
								}
							}
		,"screenshotsLinkItem"	: {"type":"custom"
									,"source" :"package>screenshots>screenshot"
									,"render":function(element,value){
										if ($(value).size()==0) {
											$(element).remove();
										} else {
											$(element).append(
												$("<a></a>")
												.attr("href","screenshots.html?p="+bundleid)
												.text('Screenshots')
											);


										}
									}
								}
    }
	
    jQuery( document ).ready(function() {
        jQuery.ajax({
            type    : "GET",
            dataType: "xml",
            url     : (bundleid+"/info.xml"),
            success : function(xml){
            	run_depiction_engine(contentBlocks,xml)
            },
			cache   : false,
            error: function() {
                $("#packageInformation").hide();
                $("#packageError").show();
            }
        }); //ajax
    }); // ready
    </script>
</head>

<body>
	<div id="packageInformation">
	
		<div id="namePanel">
			<h2>Name</h2>
			<ul>
				<li><p id="packageName"></p></li>
			</ul>
		</div>
	
	
		<div id="descriptionPanel">
			<h2>Description</h2>
			<ul id="descriptionList">
				<li id="screenshotsLinkItem"></li>
			</ul>
		</div>
		
		<div id="changesPanel">
			<h2>In this update</h2>
			<ul id="changesList">
				<li id="fullChangelogLink"></li>
			</ul>
		</div>
		
		<div id="dependenciesPanel">
			<h2>Dependencies</h2>
			<ul id="dependencyList"></ul>
		</div>
		<div id="linksPanel">
			<h2>Links</h2>
			<ul id="linksList"></ul>
		</div>
	</div>
	<div id="packageError" style="display:none">
		<h2>Error</h2>
		<ul>
			<li><p>Information for this package is not available or not hosted on this repo.</p></li>
		</ul>
	</div>
	<div id="packageContact">
		<h2>Contact</h2>
		<ul>
			<li><a class="withIcon" id="twitterLink" href="https://twitter.com/supermamon">@supermamon</a></li>
			<li><a class="withIcon" id="webLink" href="https://github.com/supermamon">Github</a></li>
			<li><a class="withIcon" id="paypalLink" href="https://www.paypal.com/cgi-bin/webscr?cmd=_donations&business=BPQNBXPYB56HL&lc=US&item_name=Send%20love%20to%20@supermamon&currency_code=USD&bn=PP%2dDonationsBF%3abtn_donateCC_LG%2egif%3aNonHosted">Contribute with Paypal</a></li>
		</ul>
	</div>
</body>
</html>
